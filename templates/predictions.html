{% extends "base.html" %}

{% block title %}Vorhersagen - Football AI{% endblock %}

{% block extra_styles %}
<style>
    .page-header {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-lg);
    }

    .filters {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        padding: 1.5rem;
        background: white;
        border-radius: 12px;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
    }

    .filter-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .filter-label {
        font-size: 0.875rem;
        font-weight: 600;
        color: #6b7280;
    }

    .filter-select,
    .filter-input {
        padding: 0.75rem 1rem;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 1rem;
        background: white;
        transition: all 0.3s;
    }

    .filter-select:focus,
    .filter-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .predictions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
        gap: 1.5rem;
    }

    .prediction-card {
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: var(--shadow);
        transition: all 0.3s;
        position: relative;
    }

    .prediction-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
    }

    .card-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1rem 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .league-badge {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
    }

    .match-date {
        font-size: 0.875rem;
        opacity: 0.9;
    }

    .card-body {
        padding: 1.5rem;
    }

    .match-teams {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1.5rem;
        font-size: 1.25rem;
        font-weight: 600;
    }

    .home-team {
        text-align: right;
        flex: 1;
    }

    .vs-separator {
        margin: 0 1rem;
        color: #9ca3af;
        font-size: 0.875rem;
    }

    .away-team {
        text-align: left;
        flex: 1;
    }

    .prediction-details {
        background: var(--light);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
    }

    .prediction-result {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
    }

    .prediction-label {
        font-size: 0.875rem;
        color: #6b7280;
    }

    .prediction-value {
        font-weight: 600;
        font-size: 1.125rem;
    }

    .confidence-bar {
        width: 100%;
        height: 8px;
        background: var(--border);
        border-radius: 4px;
        overflow: hidden;
        margin-top: 0.5rem;
    }

    .confidence-fill {
        height: 100%;
        background: linear-gradient(90deg, #ef4444 0%, #f59e0b 50%, #10b981 100%);
        transition: width 0.3s;
    }

    .confidence-badge {
        position: absolute;
        top: 1rem;
        right: 1rem;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
    }

    .high-confidence {
        background: var(--secondary);
        color: white;
    }

    .low-confidence {
        background: var(--warning);
        color: white;
    }

    .odds-section {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.5rem;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border);
    }

    .odd-item {
        text-align: center;
        padding: 0.5rem;
        background: var(--light);
        border-radius: 8px;
    }

    .odd-label {
        font-size: 0.75rem;
        color: #6b7280;
        margin-bottom: 0.25rem;
    }

    .odd-value {
        font-weight: 600;
        color: var(--primary);
    }

    .no-predictions {
        text-align: center;
        padding: 4rem 2rem;
        background: white;
        border-radius: 16px;
        box-shadow: var(--shadow);
    }

    .no-predictions-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Aktuelle Vorhersagen</h1>
    <p>NÃ¤chste Updates: Dienstag 14:00 und Freitag 18:00</p>
</div>

<div class="filters">
    <div class="filter-group">
        <label class="filter-label">Liga</label>
        <select class="filter-select" id="leagueFilter">
            <option value="">Alle Ligen</option>
            {% for code, league in leagues.items() %}
            <option value="{{ code }}" {% if filters.league == code %}selected{% endif %}>
                {{ league.emoji }} {{ league.name }}
            </option>
            {% endfor %}
        </select>
    </div>
    
    <div class="filter-group">
        <label class="filter-label">Confidence</label>
        <select class="filter-select" id="confidenceFilter">
            <option value="">Alle</option>
            <option value="high" {% if filters.confidence == 'high' %}selected{% endif %}>Nur High Confidence</option>
        </select>
    </div>
    
    <div class="filter-group">
        <label class="filter-label">Datum</label>
        <select class="filter-select" id="dateFilter">
            <option value="">Alle Tage</option>
            {% for date in dates %}
            <option value="{{ date }}" {% if filters.date == date %}selected{% endif %}>{{ date }}</option>
            {% endfor %}
        </select>
    </div>
</div>

<div class="predictions-grid">
    {% if predictions %}
        {% for pred in predictions %}
        <div class="prediction-card" data-league="{{ pred.Div }}" data-confidence="{{ pred.High_conf }}">
            {% if pred.High_conf == 1 %}
            <div class="confidence-badge high-confidence">High Confidence</div>
            {% endif %}
            
            <div class="card-header">
                <div class="league-badge">
                    <span>{{ leagues[pred.Div].emoji }}</span>
                    <span>{{ leagues[pred.Div].name }}</span>
                </div>
                <div class="match-date">
                    {{ pred.Date.strftime('%d.%m.%Y') }} - {{ pred.Time }}
                </div>
            </div>
            
            <div class="card-body">
                <div class="match-teams">
                    <span class="home-team">{{ pred.HomeTeam }}</span>
                    <span class="vs-separator">vs</span>
                    <span class="away-team">{{ pred.AwayTeam }}</span>
                </div>
                
                <div class="prediction-details">
                    <div class="prediction-result">
                        <span class="prediction-label">Vorhersage:</span>
                        <span class="prediction-value">
                            {% if pred.Prediction == 'H' %}
                                {{ pred.HomeTeam }} (Heimsieg)
                            {% elif pred.Prediction == 'D' %}
                                Unentschieden
                            {% else %}
                                {{ pred.AwayTeam }} (AuswÃ¤rtssieg)
                            {% endif %}
                        </span>
                    </div>
                    
                    <div class="prediction-result">
                        <span class="prediction-label">Confidence:</span>
                        <span class="prediction-value">{{ (pred.Confidence * 100)|round(1) }}%</span>
                    </div>
                    
                    <div class="confidence-bar">
                        <div class="confidence-fill" style="width: {{ (pred.Confidence * 100)|round }}%"></div>
                    </div>
                </div>
                
                <div class="odds-section">
                    <div class="odd-item">
                        <div class="odd-label">Heim</div>
                        <div class="odd-value">{{ pred.B365H }}</div>
                    </div>
                    <div class="odd-item">
                        <div class="odd-label">Unent.</div>
                        <div class="odd-value">{{ pred.B365D }}</div>
                    </div>
                    <div class="odd-item">
                        <div class="odd-label">Ausw.</div>
                        <div class="odd-value">{{ pred.B365A }}</div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="no-predictions">
            <div class="no-predictions-icon">ðŸ“Š</div>
            <h2>Keine Vorhersagen verfÃ¼gbar</h2>
            <p>Neue Vorhersagen werden bald generiert.</p>
        </div>
    {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const leagueFilter = document.getElementById('leagueFilter');
    const confidenceFilter = document.getElementById('confidenceFilter');
    const dateFilter = document.getElementById('dateFilter');
    
    function applyFilters() {
        const params = new URLSearchParams();
        if (leagueFilter.value) params.set('league', leagueFilter.value);
        if (confidenceFilter.value) params.set('confidence', confidenceFilter.value);
        if (dateFilter.value) params.set('date', dateFilter.value);
        
        window.location.href = '/predictions?' + params.toString();
    }
    
    leagueFilter.addEventListener('change', applyFilters);
    confidenceFilter.addEventListener('change', applyFilters);
    dateFilter.addEventListener('change', applyFilters);
});
</script>
{% endblock %}